
{% block content %}

<div class="posts">
{% if posts %}
    {% for row in posts %}
        <div class="post">
    	    <b>{{ row.displayName }}</b> shared:
            <div class="dttime">on {{ row.post.date }}</div>
    	    <br>
    	    {{ row.post.text }}
            {% if row.post.link %}
                <div class="media">
                {%  if row.post.link.endswith(".jpg") or row.post.link.endswith(".png") or row.post.link.endswith(".gif") %}

                    <img class="attachedImg" src="{{ row.post.link }}"
                     onclick="window.open('{{ row.post.link }}', '_blank');"/>

                {% else %}
                    <iframe width="560" height="315" src="{{ row.post.link.replace("/watch?v=", "/embed/") }}"
                        frameborder="0" allowfullscreen>
                    [Your browser does not support frames or is currently configured not to display frames.
                    Please use an up-to-date browser that is capable of displaying frames.]</iframe>
                {% endif %}
                </div>
            {% endif %}
            <form action="{{ url_for('social.delete_post') }}" method="post">
                    <div class="form-controls" style=" text-align: right;" >
                        <input type="hidden" name="postid" value="{{ row.post.id }}">

                        <button type="submit" class="btn btn-danger" aria-label="Left Align">
                            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                        </button>

                    </div>
            </form>

            <div class="details" style="width: 100%; text-align: center;">

                <form action="{{ url_for('social.like_post') }}" method="post">
                    <div class="form-controls" style=" text-align: right;" >
                        <input type="hidden" name="postid" value="{{ row.post.id }}">

                        <button type="submit" class="btn btn-success" aria-label="Left Align">
                            <span class="glyphicon glyphicon-thumbs-up" aria-hidden="true"></span>
                        </button>

                    </div>
                </form>

                <form action="{{ url_for('social.unlike_post') }}" method="post">
                    <div class="form-controls" style=" text-align: right;" >
                        <input type="hidden" name="postid" value="{{ row.post.id }}">

                        <button type="submit" class="btn btn-danger" aria-label="Left Align">
                            <span class="glyphicon glyphicon-thumbs-down" aria-hidden="true"></span>
                        </button>

                    </div>
                </form>
                <br>
                {% for cmt in comments %}
                    <div class="comments" style="text-align: left;">
                        {% if cmt.postid == row.post.id %}
                            <div class="form-controls" >
                                <b>{{ cmt.comment.user_display_name }}</b>:
                                {{ cmt.comment.content }}
                                {{ cmt.comment.id }}
                                {{ cmt.comment.user_sql_id }}
                                <button type="submit" class="btn btn-warning" aria-label="Left Align">
                                    <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                                </button>
                                  {% if cmt.comment.user_sql_id == session['uid'] %}
                                    <form action="{{ url_for('social.edit_comment') }}" method="post">
                                        <div class="form-controls" style="width: 100% ; text-align:left">
                                         <input type="hidden" name="commentid" value="{{ cmt.comment.id }}">
                                         <input id="editedcomment" name="editedcomment" cols="60" style="width: 100%"
                                            placeholder="Share comment">
                                            <button type="submit" class="btn btn-warning" aria-label="Left Align">
                                                <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                                            </button>
                                        </div>
                                    </form>
                                    <form action="{{ url_for('social.delete_comment') }}" method="post">
                                        <div class="form-controls" style="width: 100% ; text-align:left">
                                         <input type="hidden" name="commentid" value="{{ cmt.comment.id }}">
                                            <button type="submit" class="btn btn-danger" aria-label="Left Align">
                                                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                            </button>

                                        </div>
                                    </form>
                                {% endif %}
                            </div>
                        {% endif %}
                    </div>
                {% endfor %}

                <form action="{{ url_for('social.add_comment') }}" method="post">
                    <div class="form-controls" style="width: 100% ; text-align:left">
                        <input type="hidden" name="postid" value="{{ row.post.id }}">
                        <input id="newcomment" name="newcomment" cols="60" style="width: 100%"
                                  placeholder="Share comment">
                        <input type="submit" class="btn btn-primary" value="Comment">
                    </div>
                </form>
            </div>
        </div>
    {% endfor %}
    {% endif %}
{% if not posts %}
<p>There are no posts yet!</p>
{% endif %}
</div>
{% endblock %}
